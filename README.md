# Dr. Skin Clinic 画像スクレイピングツール

このプロジェクトは、Dr. Skin Clinic のウェブサイト (https://drskinclinic.jp/clinic/) から12の店舗画像を自動的に識別してダウンロードするためのツールです。

## 分析結果

### HTMLパターンの特定

クリニック画像は以下の特徴で識別できます：

1. **Alt属性パターン**: すべてのクリニック画像のalt属性は「院」で終わる（例：「新宿院」、「池袋院」）
2. **URL構造**: 
   - `/new/wp-content/uploads/年/月/ファイル名.jpg`
   - `/wp-content/themes/テーマ名/img/clinic/場所/ファイル名.jpg`
3. **ファイル形式**: 主に`.jpg`、一部`.png`（新橋院）

### 他の画像との区別

- **アイコン/ロゴ**: SVG形式、`/img/icons/`ディレクトリ
- **ボタン/UI要素**: 小さいサイズ、特定のクラス名
- **クリニック画像**: 高品質な写真、受付や院内の様子

## ファイル構成

```
店舗画像スクレイピング/
├── clinic_image_analysis.md    # 詳細な分析レポート
├── scrape_clinic_images.py     # 基本的なスクレイピングスクリプト
├── advanced_scraper.py         # 高度なスクレイピングスクリプト
├── requirements.txt            # Python依存関係
└── README.md                   # このファイル
```

## 使用方法

### 1. 依存関係のインストール

```bash
pip install -r requirements.txt
```

### 2. 基本スクレイピング

```bash
python scrape_clinic_images.py
```

オプション：
- `1`: クリニック画像をダウンロード
- `2`: ページ構造を分析（デバッグモード）

### 3. 高度なスクレイピング

```bash
python advanced_scraper.py
```

高度な機能：
- 複数の検出戦略
- 信頼度スコア
- JSON形式の詳細レポート
- クリニック情報の抽出

## 出力

### 基本スクレイパー
- `clinic_images/`: ダウンロードした画像
- `clinic_images/download_report.txt`: ダウンロードレポート

### 高度なスクレイパー
- `clinic_images_advanced/`: ダウンロードした画像
- `clinic_images_advanced/scrape_report.json`: JSON形式の詳細レポート
- `clinic_images_advanced/scrape_report.txt`: テキスト形式のレポート

## 画像の命名規則

ダウンロードされた画像は以下の形式で保存されます：
```
01_新宿.jpg
02_池袋.jpg
03_秋葉原.jpg
...
```

## 技術詳細

### 検出戦略

1. **Alt属性戦略** (高信頼度)
   ```python
   soup.select('img[alt$="院"]')
   ```

2. **URLパターン戦略** (中信頼度)
   ```python
   img[src*="/wp-content/uploads/"]
   ```

3. **コンテナパターン戦略** (中信頼度)
   ```python
   [class*="clinic"] img
   ```

### エラーハンドリング

- ネットワークエラーの再試行
- 無効な画像URLのスキップ
- タイムアウト設定（30秒）
- サーバーへの配慮（0.5秒の遅延）

## 注意事項

1. **利用規約**: ウェブサイトの利用規約を確認してください
2. **アクセス頻度**: サーバーに負荷をかけないよう、適切な遅延を設定しています
3. **著作権**: ダウンロードした画像の使用には注意してください

## トラブルシューティング

### 画像が見つからない場合
1. ウェブサイトの構造が変更されていないか確認
2. ネットワーク接続を確認
3. デバッグモードで実行して詳細を確認

### ダウンロードエラー
1. URLが正しくアクセスできるか確認
2. ファイアウォールやプロキシの設定を確認
3. タイムアウト値を増やす

## 今後の改善案

1. Selenium対応（動的コンテンツ用）
2. 並列ダウンロード
3. 画像のメタデータ抽出
4. 自動更新チェック機能